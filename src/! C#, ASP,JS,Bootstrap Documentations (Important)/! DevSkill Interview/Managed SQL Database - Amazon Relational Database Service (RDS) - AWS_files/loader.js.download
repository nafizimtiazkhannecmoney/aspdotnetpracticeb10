(()=>{var e={857:(e,t)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.LANGUAGE_TO_LOCALE_MAPPING=t.LanguageCode=void 0,(a=t.LanguageCode||(t.LanguageCode={})).DEFAULT="en",a.EN="en",a.ES="es",a.PT="pt",a.JP="jp",a.TW="tw",a.FR="fr",t.LANGUAGE_TO_LOCALE_MAPPING={en:"en",es:"es",pt:"pt",jp:"ja",tw:"zh_TW",fr:"fr"}},21:(e,t,a)=>{const{LanguageCode:n}=a(857),r=Object.freeze({"aws.amazon.com":function(){const e=window.location.pathname.split("/");if(e.length<2)return null;const t=e[1];return 2===t.length?t.toLowerCase():null}});e.exports={getExperimentalFeatures:function(){const e=localStorage.getItem("cb-experimentalFeatures");return e&&"string"==typeof e?JSON.parse(e):[]},getLanguageCodeFromPage:function(){const e=window.location.hostname;let t;const a=r[e];return t=a?a():function(e){let t=e?.split("/")?.find((e=>e.match("^[a-z]{2}$")))?.toLowerCase();return t??n.EN}(e+window.location.pathname),Object.values(n).includes(t)?t:n.EN},LanguageCode:n,isNetworkError:function(e){return"Failed to fetch"===e.message||"Load failed"===e.message||"The operation was aborted. "===e.message},isExpectedError:function(e){return"Unexpected end of JSON input"===e.message||"returnfalse is not defined"===e.message||e.message.includes("Cannot destructure property")||e.message.includes("Unexpected token")||e.message.includes("Unexpected end of JSON input")||e.message.includes("r.data is undefined")}}},330:(e,t,a)=>{const{getExperimentalFeatures:n,getLanguageCodeFromPage:r,isNetworkError:s,isExpectedError:o}=a(21),{LANGUAGE_TO_LOCALE_MAPPING:i,LanguageCode:c}=a(857),u=["alpha","beta","gamma","prod"],g="CHAT_LOADER_",d=`${g}AVAILABILITY`,l=`${g}COMPATIBILITY_ISSUE_COUNT`,f=`${g}NETWORK_FAILURE_COUNT`,m=`${g}EXPECTED_FAILURE_COUNT`,h=["ValidationException","ThrottlingException"];let p,T;const w="cb-trafficPercentage",y="disable_chat_ui";async function O(){try{await async function(){if(n().includes(y))return void console.log(`Chat UI disabled due to "${y}" experimental feature.`);const e=function(){const e=document.getElementById("mrc-sunrise-chat-loader")?.getAttribute("src");if(!e)return console.error("Missing required document element for chat script."),null;const t=e.split(".").slice(2,3).pop();return u.includes(t)?t:(console.error(`Unsupported stage value: ${t}`),null)}();if(!e)return;!function(e){const t="https",a="mrc-sunrise.marketing.aws.dev",n="us-east-1";p=`${t}://infra-api.${n}.${e}.${a}/custom-metric`,T=`${t}://chatbot-api.${n}.${e}.${a}/health-check`}(e);const t=window.location.hostname+window.location.pathname;if(!await async function(e){return!!localStorage||(await S(l,1,{logType:"INFO",messageObj:{hostname:e,message:"Browser HTML web storage, localStorage is null",userAgent:navigator.userAgent}}),!1)}(t))return;const{chatConfig:a,languageSupportedFeatures:g,theme:f,trafficPercentage:O,openonvisit:b,alwayson:v,headers:F,featureFlagMap:N,unauthTheme:C,unauthThemeTrafficPercentage:A,igniteSupportedFeatures:L,igniteTrafficPercentage:I}=await async function(){const e=window.location.hostname+window.location.pathname,t={hostname:e,languageCode:r()};let a,n;try{a=await fetch(T,{method:"POST",body:JSON.stringify(t)})}catch(t){return void await E(t,e)}try{n=await a.json();const r=n.error;if(r)return"The input fails to satisfy the constraints specified"===r.message&&await S(d,0,{logType:"ERROR",messageObj:{hostname:e,message:"Healthcheck returned invalid request exception",healthCheckParam:t,errorMessage:r.message}}),void h.includes(r.name);const{config:s,languageSupportedFeatures:o,theme:i,trafficPercentage:c,openonvisit:u,alwayson:g,headers:l,featureFlagMap:f,unauthTheme:m,unauthThemeTrafficPercentage:p,igniteSupportedFeatures:T,igniteTrafficPercentage:w}=n.data;if(!(s&&Object.keys(s).length&&o&&Object.keys(o).length))throw new Error(`Invalid Healthcheck response body: ${JSON.stringify(n)}`);return{chatConfig:s,languageSupportedFeatures:o,theme:i,trafficPercentage:c,openonvisit:u,alwayson:g,headers:l,featureFlagMap:f,unauthTheme:m,unauthThemeTrafficPercentage:p,igniteSupportedFeatures:T,igniteTrafficPercentage:w}}catch(a){return s(a)?void await E(a,e):o(a)?void await async function(e,t){return await S(m,1,{logType:"INFO",messageObj:{errorName:e.name,errorMessage:e.message,hostname:t,userAgent:navigator.userAgent}})}(a,e):void await S(d,0,{logType:"ERROR",messageObj:{hostname:e,message:"Error faced when parsing response",errorName:a.name,errorMessage:a.message,healthCheckRequest:JSON.stringify(t),healthCheckResponse:JSON.stringify(n)}})}}()||{};if(a&&g&&function(e,t=1){return 1===t||e<t}(function(){let e;const t=localStorage.getItem(w);if(t){const a=JSON.parse(t);e="number"!=typeof a?.expiryTimestamp||a.expiryTimestamp<Date.now()?P():parseFloat(a.generatedPercentage)}else e=P();return e}(),O)){!function(e){localStorage.setItem("cb-featureFlagMap",JSON.stringify(e))}(N);try{!function({chatConfig:e,languageSupportedFeatures:t,theme:a,openonvisit:n,alwayson:r,headers:s,unauthTheme:o,unauthThemeTrafficPercentage:u,igniteSupportedFeatures:g,igniteTrafficPercentage:d}){let l=document.getElementById("mrc-sunrise-chat");l||(l=document.createElement("div"),l.id="mrc-sunrise-chat",document.body.appendChild(l)),function({chatMountingPoint:e,languageSupportedFeatures:t,theme:a,openonvisit:n,alwayson:r,unauthTheme:s,unauthThemeTrafficPercentage:o,igniteSupportedFeatures:u,igniteTrafficPercentage:g}){(function(e,t){let a;if(e.dataset.language)a=e.dataset.language;else{const n=window.location.pathname?.split("/")[1];a=Object.keys(t).indexOf(n)>-1?n:c.DEFAULT,e.dataset.language=a}e.dataset.locale||(e.dataset.locale=i[a]);const n=t[a]||{},r=Object.keys(n);for(let t=0;t<r.length;t++){const a=r[t],s=`${a}Enabled`;e.dataset[s]||(e.dataset[s]=n[a])}})(e,t),function(e,t){t&&!e.dataset.theme&&("webview-blue"===t?(e.dataset.theme="blue",e.dataset.webview="true",e.dataset.eventApp="true",e.dataset.alwayson="true"):e.dataset.theme=t)}(e,a),function(e,t,a){t&&!e.dataset.unauththeme&&(e.dataset.unauthTheme=t),a&&!e.dataset.unauthThemeTrafficPercentage&&(e.dataset.unauthThemeTrafficPercentage=a)}(e,s,o),function(e,t){e.dataset.openonvisit=e.dataset.openonvisit||t?"true":"false"}(e,n),function(e,t){e.dataset.alwayson=e.dataset.alwayson||t?"true":"false"}(e,r),function(e,t,a){t&&(e.dataset.igniteSupportedFeatures=JSON.stringify(t)),void 0!==a&&(e.dataset.igniteTrafficPercentage=a)}(e,u,g)}({chatMountingPoint:l,languageSupportedFeatures:t,theme:a,openonvisit:n,alwayson:r,unauthTheme:o,unauthThemeTrafficPercentage:u,igniteSupportedFeatures:g,igniteTrafficPercentage:d}),localStorage.setItem("cb-config",JSON.stringify(e));const f=document.createElement("script");f.src=e.chatAppScriptPath,f.defer="defer",document.body.appendChild(f),function(e){const t=e?.cloudFrontCountry;localStorage.setItem("cb-headers",JSON.stringify({...t&&{cloudFrontCountry:t}}))}(s)}({chatConfig:a,languageSupportedFeatures:g,theme:f,openonvisit:b,alwayson:v,headers:F,unauthTheme:C,unauthThemeTrafficPercentage:A,igniteSupportedFeatures:L,igniteTrafficPercentage:I})}catch(e){return void await S(l,1,{logType:"INFO",messageObj:{errorName:e.name,errorMessage:e.message,hostname:t,message:"Mount chat script failed",userAgent:navigator.userAgent}})}await S(d,1,{logType:"INFO",messageObj:{hostname:t,message:"Chat script loaded"}})}}()}catch(e){}}const S=async(e,t,a)=>{try{await fetch(p,{method:"POST",body:JSON.stringify({metrics:[{metric:{name:e,value:t,unit:"Count"},logMessage:a}],namespace:"ChatUi"})})}catch(e){}};function P(){const e=Math.random();return localStorage.setItem(w,JSON.stringify({generatedPercentage:e,expiryTimestamp:Date.now()+432e5})),e}async function E(e,t){return await S(f,1,{logType:"INFO",messageObj:{errorName:e.name,errorMessage:e.message,hostname:t,userAgent:navigator.userAgent}})}O(),"object"==typeof process&&(e.exports=O)}},t={};!function a(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,a),s.exports}(330)})();